https://github.com/haruki1953/240525-bangumi-list-dev-diary
# 一、项目介绍
这个项目叫 bangumi-list。

自己番剧小窝用的是alist，这种返璞归真的方法导致了番剧的展示不太优雅。
bangumi-list 将会完善这一方面。

bangumi-list 是一个前端，用于整理与显示番剧数据，通过番剧卡片中的 “下载/观看”按钮 可以跳转到alist。
bangumi-list 通过请求服务上的一些文件来获取番剧数据，没有真正意义上的后端，番剧数据是通过一个python爬虫生成的。

## 技术栈
- vue3
- element-plus
- python

## 项目搭建分为两期
### 一期
- 修改python爬虫，将现有爬取的数据保存在指定文件。需要注意的是，还缺少bangumi的id，也要保存。
- 夜间模式、自定义主题
- 前端：获取全部番剧数据，根据最后修改标记按需获取。
- 首页：显示当季番剧
- 番剧列表页：显示全部番剧，搜索功能，按季度分组、按评分排序、按时间排序
- 部署：实现与现有alist的兼容，现有alist网址为 bangumi.sakiko.top，尝试让前端也部署在此域名下

### 二期
- 收藏页
- 修改爬虫爬取更多信息、
- 番剧主页：显示更多信息
- 相似番剧推荐（番剧主页、收藏页）
- 更新集数显示
- 公告功能


# 二、后端
感觉必须要重写了，好乱

- 生成数据

（剩下的二期再说吧）
- 改用模板引擎
- 优化结构

## 生成数据
生成的番剧数据保存在网站目录下的data文件夹下
python爬虫是通过多个`crawl_info.json`来获取数据的，根据不同的源文件生成不同的`bgm_data.json`，同时生成或修改`config.json`

crawl_info.json，需要新增alistPath字段，在自动截取名称链接出问题时进行补正
> 一般通过saveFile字段就可以截取出正确的alist路径，但极少数情况下会有问题。如果发现这种情况，就添加正确的alistPath
```json
[
    {
        "saveFile": "/home/onedrive/Sakiko/Bangumi/BUCCHIGIRI?!/readme.md",
        "urlList": [
            {
                "source": "bangumi",
                "url": "https://bangumi.tv/subject/436745",
                "alistPath": "/Bangumi/BUCCHIGIRI？!"
            }
        ]
    }
    // ...
]
```

config.json，负责保存生成`bgm_data.json`番剧数据，通过其中的最后修改时间，来控制前端在必要时再请求数据
```json
{
	"bgmFileList": [
		{
			"fileName": "文件名，如 bgm_data-crawl_info_24四月.json",
			"lastModified": "最后修改时间",
			"showOnHome": "是否在首页显示"
		}
		// ...
	]
}
```
（一期）

bgm_data.json保存番剧数据
```json
[
	{
		"id": "bangumi番剧ID，也在前端里用作id",
		"alistPath": "对应番剧的alist网站路径",
		"bgmUrl": "bangumi番剧链接",
		"img": "番剧图片",
		"name": "番剧名（日语）",
		"chineseName": "中文名",
		"episode": "话数",
		"date": "放送开始日期",
		"weekday": "放送星期",
		"score": "评分",
		"charsInfo": [
			{
				"img": "角色的图片"
			}
		],
		"comments": [
			{
				"img": "用户头像",
				"name": "用户名",
				"content": "评论内容"
			}
		]
	}
]
```
（一期）其中都是已经完成爬取的数据，虽然有些不是当前必须的，但为了以后方便还是处理了。以后还要爬取的有：
- 详细角色信息
- 每集的信息
- 标签


# 三、前端
请求获取config.json，并根据其内容获取bgm_data.json，通过判断lastModified在必要时重新获取

## 首页
根据请求获取的config.json显示番剧，按星期分组并根据当前日期显示

## 番剧列表页











